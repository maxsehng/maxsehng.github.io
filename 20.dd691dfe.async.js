(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"/1Bz":function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("U2gH");var n=r(a("kT6h")),l=a("8ur3"),i=c(a("xwgP")),o=a("pG04"),s=r(a("7hB9")),d=r(a("guZp")),u=r(a("L0Kt"));function p(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(p=function(e){return e?a:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,a&&a.set(e,r),r}class f extends i.Component{constructor(e){var t;super(e),t=this,this.getFilterItems=(e=>{return[{text:"\u72b6\u6001",name:"upgradeState",value:e.upgradeState,type:"select",allowClear:!0,style:{width:150},options:[{text:"\u5168\u90e8",value:""},{text:"\u51c6\u5907\u4e2d",value:"WAITING"},{text:"\u5347\u7ea7\u4e2d",value:"UPGRADING"},{text:"\u5df2\u53d6\u6d88",value:"CANCELED"},{text:"\u5df2\u5b8c\u6210",value:"COMPLETED"}]},{text:"\u8bbe\u5907\u5e8f\u5217\u53f7",name:"sn",value:e.sn,type:"input"},{text:"\u8bbe\u5907\u7c7b\u578b",name:"model",value:e.model,component:i.default.createElement(d.default,{dataUrl:"/dev/getModels",textName:"name",valueName:"id",searchName:"name",width:150,onChange:this.modelOnChange})},{text:"\u7248\u672c\u53f7",name:"version",value:e.version,component:i.default.createElement(d.default,{dataUrl:"/iso/getVersions",textName:"version",valueName:"id",searchName:"version",paramName:"model",paramValue:this.state.modelType,width:150})},{text:"\u65f6\u95f4",name:"date",value:e.date,type:"daterange"}]}),this.modelOnChange=(e=>{this.setState({modelType:e||"none"});var t=this.QueryForm.props.form;t&&t.setFieldsValue&&t.setFieldsValue({version:void 0})}),this.snContent=(e=>{return i.default.createElement("div",{style:{width:302,minHeight:100}},e.map((e,t)=>{return i.default.createElement("span",{key:"".concat(e).concat(t),style:{display:"inline-block",padding:"6px 10px",border:"1px solid #e6e6e6",marginRight:8,marginBottom:8}},e)}))}),this.addsContent=(e=>{return i.default.createElement("div",{style:{width:302,minHeight:100}},e.map((e,t)=>{return i.default.createElement("span",{key:"".concat(e).concat(t),style:{display:"inline-block",padding:"6px 10px",border:"1px solid #e6e6e6",marginRight:8,marginBottom:8}},"".concat(e[0]).concat(e.length>1&&e[1]?"/".concat(e[1]):"").concat(e.length>2&&e[2]?"/".concat(e[2]):""))}))}),this.rangeDiv=(e=>{return e?"sn"===e.type?i.default.createElement(n.default,{content:this.snContent(e.value),title:"\u8bbe\u5907\u5e8f\u5217\u53f7"},e.value.map((e,t)=>{return t<3?i.default.createElement("span",{key:"".concat(e),style:{padding:"6px 10px",border:"1px solid #e6e6e6",marginRight:6}},e):3===t?i.default.createElement("span",{key:"".concat(e)},"..."):null})):"adds"===e.type||"label"===e.type?i.default.createElement(n.default,{content:this.addsContent(e.value),title:"adds"===e.type?"\u5730\u533a":"\u6807\u7b7e"},e.value.map((e,t)=>{return t<1?i.default.createElement("span",{key:"".concat(e),style:{padding:"6px 10px",border:"1px solid #e6e6e6",marginRight:6}},"".concat(e[0]).concat(e.length>1&&e[1]?"/".concat(e[1]):"").concat(e.length>2&&e[2]?"/".concat(e[2]):"")):1===t?i.default.createElement("span",{key:"".concat(e)},"..."):null})):void 0:i.default.createElement("span",{key:"all",style:{padding:"6px 10px",border:"1px solid #e6e6e6",marginRight:6}},"\u6240\u6709\u8bbe\u5907")}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=t.props.dispatch;n({type:"upgradestrategy/fetch",payload:{filter:e,pageNo:a,pageSize:r}})},this.queryRate=(e=>{var t=e.id,a=e.upgradeState,r=this.props,n=r.showProgress,l=r.dispatch;l({type:"upgradestrategy/queryProgress",payload:{filter:{id:t}}}),n&&n(t,a)}),this.cancelSend=(e=>{var t=e.id,a=this.props.dispatch;a({type:"upgradestrategy/cancelSend",payload:{id:t}})}),this.add=((e,t)=>{var a=this.props.dispatch;a({type:"upgradestrategy/add",payload:{values:e},callback:{onSuccess:t}})}),this.edit=((e,t)=>{var a=this.props.dispatch;a({type:"upgradestrategy/edit",payload:{values:e},callback:{onSuccess:t}})}),this.showFormModal=(e=>{this.setState({addModalVisible:!0,editRowData:e})}),this.hideFormModal=(()=>{this.setState({addModalVisible:!1,editRowData:""})}),this.render=(()=>{var e=this.props,t=e.loading,a=e.upgradestrategy,r=e.addLoading,n=(e.app.user,this.state),l=n.addModalVisible,d=n.editRowData;return i.default.createElement("div",null,i.default.createElement(o.Grid,{formprop:{initNums:2,wrappedComponentRef:e=>this.QueryForm=e},filterInline:!0,filterItems:this.getFilterItems(a.filter),wrappedComponentRef:e=>this.filterForm=e,columns:this.columns,loading:t,data:a,refersh:this.refersh,delAction:e=>{return"\u5347\u7ea7\u4e2d"===e.upgradeState},toolBtns:2!=sessionStorage.getItem("roleId")?[{icon:"plus-circle",text:"\u6dfb\u52a0",handler:this.showFormModal}]:[],actions:2!=sessionStorage.getItem("roleId")?[{text:"\u8fdb\u5ea6\u67e5\u8be2",check:e=>{return"WAITING"!==e.upgradeState},handler:e=>{this.queryRate(e)}},{text:"\u53d6\u6d88",confirm:"\u8bf7\u786e\u8ba4\u53d6\u6d88!",check:e=>{return"WAITING"===e.upgradeState||"SUSPEND"===e.upgradeState||"UPGRADING"===e.upgradeState},handler:e=>{this.cancelSend(e)}}]:[{text:"\u8fdb\u5ea6\u67e5\u8be2",check:e=>{return"WAITING"!==e.upgradeState},handler:e=>{this.queryRate(e)}}]}),i.default.createElement(s.default,{rowData:d,visible:l,onSubmit:this.add,edit:this.edit,addLoading:r,onClose:this.hideFormModal}))}),this.state={pullVisible:!1,addModalVisible:!1,editRowData:""},this.columns=[{title:"\u72b6\u6001",dataIndex:"upgradeState",render:e=>{return"WAITING"===e?"\u51c6\u5907\u4e2d":"UPGRADING"===e?"\u5347\u7ea7\u4e2d":"CANCELED"===e?"\u5df2\u53d6\u6d88":"SUSPEND"===e?"\u6682\u505c\u4e2d":"\u5df2\u5b8c\u6210"}},{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u7248\u672c\u53f7",dataIndex:"versionName",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.model+"/"+e}},{title:"\u8fdb\u5ea6",dataIndex:"rate",render:(e,t)=>{return"WAITING"===t.upgradeState?i.default.createElement("span",null,"\u51c6\u5907\u4e2d"):i.default.createElement("span",null,t.success,"/",t.total)}},{title:"\u8303\u56f4",dataIndex:"range",render:e=>{return this.rangeDiv(e)}},{title:"\u5347\u7ea7\u65f6\u95f4",render:e=>{return e.validStart&&e.validEnd?(0,u.default)(e.validStart).format("HH:mm:ss")+" -- "+(0,u.default)(e.validEnd).format("HH:mm:ss"):null}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime"}]}}function m(e){var t=e.upgradestrategy,a=e.loading,r=e.app;return{app:r,upgradestrategy:t,loading:a.effects["upgradestrategy/fetch"],addLoading:a.effects["upgradestrategy/add"]}}var g=(0,l.connect)(m)(f);t.default=g},"1PG4":function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("26gd");var n=r(a("1GiV"));a("6/yB");var l=r(a("SE39"));a("Mf8d");var i=r(a("4OHk")),o=r(a("xwgP")),s=(r(a("s21K")),a("pG04")),d=r(a("guZp")),u=()=>{return o.default.createElement(l.default,{title:o.default.createElement("div",null,o.default.createElement("span",null,"\u793a\u4f8b:"),o.default.createElement("span",{style:{marginLeft:10}},"5.4.0 (11432)"))},o.default.createElement(i.default,{type:"info-circle",style:{color:"rgba(0,0,0,.45)"}}))};class p extends o.default.Component{constructor(e){super(e),this.getFields=(()=>{return[{text:"\u8bbe\u5907\u7c7b\u578b",name:"model",labelcol:6,component:o.default.createElement(d.default,{dataUrl:"/dev/getModels",textName:"name",valueName:"id",searchName:"name",onChange:this.onChange}),validate:[{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bbe\u5907\u7c7b\u578b"}],trigger:["onBlur","onChange"]}]},{text:"\u7248\u672c\u53f7",labelcol:6,name:"version",type:"beforeinputafter",afterComponent:o.default.createElement(u,null),validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7248\u672c\u53f7"}],trigger:["onBlur","onChange"]}]},{text:"\u9009\u62e9\u6587\u4ef6",labelcol:6,name:"file",type:"upload",validate:[{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5347\u7ea7\u5305\u8fdb\u884c\u4e0a\u4f20"}],trigger:["onBlur","onChange"]}],url:"/api/iso/upload",fileSizeLimit:100,onSuccess:e=>{var t=this.props.onSuccess;e.success?(n.default.info("\u5bfc\u5165\u6210\u529f"),t()):n.default.error(e.message),this.setState({loading:!1})},onError:e=>{n.default.error("\u5bfc\u5165\u5931\u8d25"),this.setState({loading:!1})}}]}),this.onChange=(e=>{this.setState({modelType:e})}),this.upload=(e=>{this.setState({loading:!0})}),this.render=(()=>{var e=this.props,t=e.visible,a=e.onClose,r=this.state.loading;return o.default.createElement(s.Form.Modal,{title:"\u4e0a\u4f20\u5347\u7ea7\u5305",visible:t,fields:this.getFields(),confirmLoading:r,onCancel:a,onSubmit:this.upload})}),this.state={modelType:"",loading:!1}}}t.default=p},"7hB9":function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("exa0");var n=r(a("KiF4"));a("SMEU");var l=r(a("xc0u"));a("Mf8d");var i=r(a("4OHk"));a("nPjb");var o=r(a("nKmx"));a("C1KP");var s=r(a("d6B9")),d=r(a("zAuD"));a("26gd");var u=r(a("1GiV"));a("vJ22");var p=r(a("BPQb")),c=a("8ur3"),f=E(a("xwgP")),m=r(a("J1Jx")),g=r(a("pOAv")),h=r(a("guZp")),v=r(a("QiSa")),y=r(a("L0Kt"));function b(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(b=function(e){return e?a:t})(e)}function E(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,a&&a.set(e,r),r}function x(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=w(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw l}}}}function w(e,t){if(e){if("string"===typeof e)return I(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var C=0,S=p.default.Group,k={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},P={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}};class O extends f.Component{constructor(e){super(e),this.remove=(e=>{var t=this.props.form,a=t.getFieldValue("keys");1!==a.length&&t.setFieldsValue({keys:a.filter(t=>t!==e)})}),this.add=(()=>{var e=this.props.form,t=e.getFieldValue("keys");if(t.length>=6)u.default.error("\u4e00\u6b21\u6700\u591a\u8bbe\u7f6e6\u4e2a\u6761\u76ee");else{var a=t.concat(C++);e.setFieldsValue({keys:a})}}),this.onClose=(()=>{var e=this.props,t=e.onClose,a=e.form;a&&a.resetFields(),this.setState({rangeValue:void 0,snData:void 0}),t&&t()}),this.handleOk=(e=>{var t=this.props,a=t.onSubmit,r=t.edit,n=t.rowData;e.preventDefault(),this.props.form.validateFields((e,t)=>{if(!e){var l=[];if("adds"===t.range){var i,o=x(t.keys);try{var s=function(){var e=i.value,a={},r="adds"+e,n=void 0;n=Array.isArray(t[r])?t[r]:t[r].split(","),a.country=n[0],a.region=n[1],a.locality=n[2];var o=l.find(e=>e.country===a.country&&e.region===a.region&&e.locality===a.locality);if(o)return u.default.error("\u5b58\u5728\u76f8\u540c\u7684\u5730\u533a\uff0c\u8bf7\u4fee\u6539!"),{v:void 0};l.push(a)};for(o.s();!(i=o.n()).done;){var d=s();if("object"===typeof d)return d.v}}catch(e){o.e(e)}finally{o.f()}if(0===l.length)return void u.default.error("\u8bf7\u5148\u6dfb\u52a0\u5730\u533a")}else if("label"===t.range){var p,c=x(t.keys);try{var f=function(){var e=p.value,a={},r="labels"+e,n=t[r];a.title=n[0],a.content=n[1];var i=l.find(e=>e.title===a.title&&e.content===a.content);if(i)return u.default.error("\u5b58\u5728\u76f8\u540c\u7684\u6807\u7b7e\uff0c\u8bf7\u4fee\u6539!"),{v:void 0};l.push(a)};for(c.s();!(p=c.n()).done;){var m=f();if("object"===typeof m)return m.v}}catch(e){c.e(e)}finally{c.f()}if(0===l.length)return void u.default.error("\u8bf7\u5148\u6dfb\u52a0\u6807\u7b7e")}else l=t.sn;t.rangeValue=JSON.stringify(l),n&&n.id?(t.id=n&&n.id,r(t,this.onClose)):a&&a(t,this.onClose)}})}),this.labelOnChange=(e=>{var t=this.props.form;t.setFieldsValue({keys:[]}),this.setState({rangeValue:e.target.value})}),this.modelOnChange=(e=>{var t=this.props.form;t.setFieldsValue({version:void 0,sn:void 0}),this.setState({modelType:e})}),this.formFixedItems=(()=>{var e=this.props.rowData,t=[];e.validStart&&e.validEnd&&(t.push((0,y.default)(e.validStart).year((0,y.default)().get("year")).month((0,y.default)().get("month")).date((0,y.default)().get("date"))),t.push((0,y.default)(e.validEnd).year((0,y.default)().get("year")).month((0,y.default)().get("month")).date((0,y.default)().get("date"))));var a=this.props.form.getFieldDecorator,r=this.state.modelType;return f.default.createElement(f.Fragment,null,f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u8bbe\u5907\u7c7b\u578b",required:!0,key:"\u8bbe\u5907\u7c7b\u578b"}),a("model",{initialValue:e.model,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8bbe\u5907\u7c7b\u578b"}]})(f.default.createElement(h.default,{dataUrl:"/dev/getModels",textName:"name",valueName:"id",searchName:"name",onChange:this.modelOnChange}))),f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u7248\u672c\u53f7",required:!0,key:"\u7248\u672c\u53f7"}),a("version",{initialValue:e.version,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c\u53f7"}]})(f.default.createElement(h.default,{dataUrl:"/iso/getVersions",textName:"version",valueName:"id",searchName:"version",paramName:"model",paramValue:r||e.model}))),f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u540d\u79f0",required:!0,key:"\u540d\u79f0"}),a("name",{initialValue:e.name,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7b56\u7565\u540d\u79f0"}]})(f.default.createElement(o.default,{placeholder:"\u8bf7\u586b\u5199\u7b56\u7565\u540d\u79f0"}))),f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u5347\u7ea7\u65f6\u95f4",key:"\u5347\u7ea7\u65f6\u95f4"}),a("upgradeTime",{initialValue:t,validateTrigger:["onChange","onBlur"],rules:[{message:"\u8bf7\u9009\u62e9\u5b8c\u6574\u65f6\u95f4",validator:(e,t,a)=>{0===t.length||t[0]&&t[1]||null===t[0]&&null===t[1]?a():a("\u8bf7\u9009\u62e9\u5b8c\u6574\u65f6\u95f4")}}]})(f.default.createElement(v.default,{showType:"time",width:472}))),f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u8303\u56f4",required:!0,key:"\u8303\u56f4"}),a("range",{initialValue:e.range&&e.range.type?e.range.type:e.all?"all":null,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8303\u56f4\u7c7b\u578b"}]})(f.default.createElement(S,{onChange:this.labelOnChange},f.default.createElement(p.default,{value:"all"},"\u6240\u6709\u8bbe\u5907"),f.default.createElement(p.default,{value:"sn"},"\u8bbe\u5907"),f.default.createElement(p.default,{value:"adds"},"\u5730\u533a"),f.default.createElement(p.default,{value:"label"},"\u6807\u7b7e")))))}),this.snFormItems=(()=>{var e=this.props.rowData,t=this.state.modelType,a=this.props.form.getFieldDecorator,r=this.props.app.user;return f.default.createElement(s.default.Item,(0,d.default)({},k,{label:"\u8bbe\u5907\uff1a",required:!0,key:"\u8bbe\u5907"}),a("sn",{initialValue:e.range&&"sn"===e.range.type&&e.range.value,validateTrigger:["onChange","onBlur"],rules:[{validator:(e,t,a)=>{t&&""!=t&&0!=t.length?t.length>50?a("\u4e00\u6b21\u6700\u591a\u9009\u62e950\u53f0\u8bbe\u5907"):a():a("\u8bf7\u9009\u62e9\u8bbe\u5907")}}]})(f.default.createElement(h.default,{dataUrl:r.companyUser?"/dev/list":"/dev/list?companyId=-1",textName:"sn",valueName:"sn",searchName:"sn",formProps:{mode:"multiple",placeholder:"\u8bf7\u9009\u62e9\u8bbe\u5907"},paramName:"model",paramValue:t})))}),this.addsFormItems=(()=>{var e=this.props.rowData,t=this.props.form,a=t.getFieldValue,r=t.getFieldDecorator,n=a("keys"),l=n.map((t,a)=>f.default.createElement(f.Fragment,{key:"\u5730\u533a".concat(t).concat(a)},f.default.createElement(s.default.Item,(0,d.default)({},0===a?k:P,{label:0===a?"\u5730\u533a\uff1a":"",required:!0,key:"\u5730\u533a".concat(t)}),r("adds".concat(t),{initialValue:e.range&&e.range.value.length>a?e.range.value[t]:null,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5730\u533a"}]})(f.default.createElement(m.default,null)),f.default.createElement(i.default,{style:{marginLeft:10},className:"dynamic-delete-button",type:"minus-circle-o",onClick:()=>this.remove(t)}))));return l}),this.labelFormItems=(()=>{var e=this.props.rowData,t=this.props.form,a=t.getFieldValue,r=t.getFieldDecorator,n=a("keys"),l=n.map((t,a)=>f.default.createElement(f.Fragment,{key:"\u6807\u7b7e".concat(t).concat(a)},f.default.createElement(s.default.Item,(0,d.default)({},0===a?k:P,{label:0===a?"\u6807\u7b7e\uff1a":"",required:!0,key:"\u6807\u7b7e".concat(t)}),r("labels".concat(t),{initialValue:e.range&&e.range.value.length>a?e.range.value[t]:null,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6807\u7b7e"}]})(f.default.createElement(g.default,{width:452})),f.default.createElement(i.default,{style:{marginLeft:10},className:"dynamic-delete-button",type:"minus-circle-o",onClick:()=>this.remove(t)}))));return l}),this.render=(()=>{var e=this.props,t=e.visible,a=e.rowData,r=e.addLoading,o=this.state.rangeValue,s=this.props.form.getFieldDecorator,d=[];if(a.range&&a.range.value&&a.range.value.length){C+=a.range.value.length;var u=0;while(u<a.range.value.length)d.push(u),u++}s("keys",{initialValue:d});var p=a.range&&"sn"===a.range.type&&a.range.value,c=a.range&&"adds"===a.range.type&&a.range.value,m=a.range&&"label"===a.range.type&&a.range.value;return f.default.createElement(n.default,{title:a.id?"\u7f16\u8f91":"\u6dfb\u52a0",visible:t,onOk:this.handleOk,onCancel:this.onClose,width:650,confirmLoading:r},f.default.createElement("div",{style:{height:500,overflowY:"auto"}},this.formFixedItems(),"sn"===o||p?this.snFormItems():"adds"===o||c?this.addsFormItems():"label"===o||m?this.labelFormItems():null,"adds"===o||"label"===o||c||m?f.default.createElement(l.default,{type:"dashed",onClick:this.add,style:{width:"60%",marginLeft:"20%"}},f.default.createElement(i.default,{type:"plus"})," \u6dfb\u52a0"):null))}),this.state={rangeValue:"",modelType:""}}}function N(e){var t=e.app;return{app:t}}var D=(0,c.connect)(N)(s.default.create()(O));t.default=D},"99qf":function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(a("xwgP")),l=a("8ur3"),i=a("pG04"),o=r(a("1PG4")),s=r(a("guZp"));function d(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(d=function(e){return e?a:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=d(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,a&&a.set(e,r),r}class p extends n.Component{constructor(e){var t;super(e),t=this,this.getFilterItems=(e=>{return[{text:"\u8bbe\u5907\u7c7b\u578b",name:"model",value:e.model,component:n.default.createElement(s.default,{dataUrl:"/dev/getModels",textName:"name",valueName:"id",searchName:"name",width:150,onChange:this.modelOnChange})},{text:"\u7248\u672c\u53f7",name:"version",value:e.version,component:n.default.createElement(s.default,{dataUrl:"/iso/getVersions",textName:"version",valueName:"id",searchName:"version",paramName:"model",paramValue:this.state.modelType,width:150})},{text:"\u65f6\u95f4",name:"date",value:e.date,type:"daterange"}]}),this.modelOnChange=(e=>{this.setState({modelType:e||"none"});var t=this.QueryForm.props.form;t&&t.setFieldsValue&&t.setFieldsValue({version:void 0})}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=t.props.dispatch;n({type:"upgrade/fetch",payload:{filter:e,pageNo:a,pageSize:r}})},this.del=(e=>{var t=e.id,a=this.props.dispatch;a({type:"upgrade/del",payload:{id:t}})}),this.showImport=(()=>{this.setState({importModalVisible:!0})}),this.hideImport=(()=>{this.setState({importModalVisible:!1})}),this.importSuccess=(()=>{this.hideImport();var e=this.props.dispatch;e({type:"upgrade/fetch"})}),this.render=(()=>{var e=this.props,t=e.upgrade,a=e.loading,r=(e.app.user,this.state.importModalVisible);return n.default.createElement("div",null,n.default.createElement(o.default,{visible:r,onClose:this.hideImport,onSuccess:this.importSuccess}),n.default.createElement(i.Grid,{formprop:{initNums:3,wrappedComponentRef:e=>this.QueryForm=e},filterInline:!0,filterItems:this.getFilterItems(t.filter),columns:this.columns,loading:a,data:t,del:2!=sessionStorage.getItem("roleId")&&this.del,refersh:this.refersh,toolBtns:2!=sessionStorage.getItem("roleId")?[{icon:"upload",text:"\u4e0a\u4f20\u5347\u7ea7\u5305",handler:this.showImport}]:[]}))}),this.state={importModalVisible:!1,modelType:"none"},this.columns=[{title:"\u8bbe\u5907\u7c7b\u578b",dataIndex:"model"},{title:"\u7248\u672c\u53f7",dataIndex:"version"},{title:"\u4e0a\u4f20\u65f6\u95f4",dataIndex:"createTime"}]}}function c(e){var t=e.upgrade,a=e.loading,r=e.app;return{app:r,upgrade:t,loading:a.models.upgrade}}var f=(0,l.connect)(c)(p);t.default=f},RTPk:function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(a("xwgP"));a("OmhE");var l=r(a("r8hw"));a("NWD0");var i=r(a("2L3m"));a("4ADO");var o=r(a("wty1"));a("SMEU");var s=r(a("xc0u")),d=a("8ur3"),u=a("pG04"),p=r(a("aP11"));function c(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,a&&a.set(e,r),r}class m extends n.Component{constructor(e){var t;super(e),t=this,this.getFilterItems=(()=>{var e=this.props.upgradeId;return[{text:"\u72b6\u6001",name:"status",type:"select",allowClear:!0,style:{width:120},options:[{text:"\u5168\u90e8",value:null},{text:"\u672a\u5f00\u59cb",value:"WAITING"},{text:"\u5347\u7ea7\u4e2d",value:"UPGRADING"},{text:"\u5df2\u53d6\u6d88",value:"CANCELED"},{text:"\u5df2\u5b8c\u6210",value:"COMPLETED"},{text:"\u5df2\u5931\u8d25",value:"FAILED"}]},{text:"\u8bbe\u5907",name:"sn",type:"input"},{text:"",name:"id",type:"hide",value:e}]}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=t.props.dispatch;n({type:"upgradestrategy/queryProgress",payload:{filter:e,pageNo:a,pageSize:r}})},this.render=(()=>{var e=this.props,t=e.loading,a=e.backFunc,r=e.upgradestrategy;return n.default.createElement("div",null,n.default.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},n.default.createElement("span",{style:{fontSize:16,fontWeight:"bold",color:"#333",marginBottom:25,lineHeight:"32px"}},"\u5347\u7ea7\u8be6\u60c5"),n.default.createElement(s.default,{type:"primary",onClick:a},"\u8fd4\u56de")),n.default.createElement(i.default,null,n.default.createElement(o.default,{span:6},n.default.createElement("div",{style:{fontSize:16,color:"#333",textAlign:"center",marginTop:50}},"\u5347\u7ea7\u6210\u529f\u7387"),n.default.createElement("div",{style:{position:"relative",width:90,height:90,margin:"40px auto"}},n.default.createElement(p.default,{color:"#13c2c2",finishColor:"#000",percent:0===r.finishCount?0:parseInt(r.finishCount/r.configCount*100,10)}),n.default.createElement("div",{style:{position:"absolute",top:28,left:0,zIndex:9999,width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},n.default.createElement("span",{style:{fontSize:24,color:"#13c2c2",fontWeight:"bold"}},0===r.finishCount?0:parseInt(r.finishCount/r.configCount*100,10)),n.default.createElement("span",{style:{fontSize:12,color:"#13c2c2"}},"%"))),n.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},n.default.createElement("div",{style:{fontSize:16,color:"#333",textAlign:"center",marginBottom:15}},"\u5347\u7ea7\u6570\u91cf: ",r.configCount,"\u53f0"),n.default.createElement("div",{style:{fontSize:16,color:"#333",textAlign:"center",marginBottom:15}},"\u5df2\u5347\u7ea7\u6570\u91cf: ",r.finishCount,"\u53f0"))),n.default.createElement(o.default,{span:18},n.default.createElement(u.Grid,{formprop:{initNums:3},filterInline:!0,filterItems:this.getFilterItems(),columns:this.columns,loading:t,data:r.progress,refersh:this.refersh}))))}),this.state={showTab:"strategy"},this.columns=[{title:"\u72b6\u6001",dataIndex:"status",render:t=>{return"FAILED"===t?"UPGRADING"===e.upgradeState?"\u5df2\u5931\u8d25(\u91cd\u65b0\u5347\u7ea7\u4e2d...)":"\u5df2\u5931\u8d25":"UPGRADING"===t?"\u5347\u7ea7\u4e2d":"CANCELED"===t?"\u5df2\u53d6\u6d88":"PREPARE"===t?"\u51c6\u5907\u4e2d":"\u5df2\u5b8c\u6210"}},{title:"\u8bbe\u5907\u5e8f\u5217\u53f7",dataIndex:"sn"},{title:"\u8fdb\u5ea6",dataIndex:"percent",render:(e,t)=>{var a=t.status;return"CANCELED"===a||"FAILED"===a?n.default.createElement(l.default,{percent:e,strokeColor:"#f76260",status:"exception"}):n.default.createElement(l.default,{percent:e,strokeColor:"#13c2c2"})}}]}}function g(e){var t=e.upgradestrategy,a=e.loading;return{upgradestrategy:t,loading:a.models.devconfig}}var h=(0,d.connect)(g)(m);t.default=h},SKQG:function(e,t,a){"use strict";var r=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=p(a("xwgP"));a("WguZ");var l=r(a("spxj")),i=a("8ur3"),o=r(a("99qf")),s=r(a("/1Bz")),d=r(a("RTPk"));r(a("L0Kt"));function u(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(u=function(e){return e?a:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=u(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,a&&a.set(e,r),r}var c=l.default.TabPane;class f extends n.Component{constructor(e){super(e),this.onChange=(e=>{var t=this.props.dispatch;"list"===e?t({type:"upgrade/fetch"}):"strategy"===e&&t({type:"upgradestrategy/fetch"}),this.setState({showTab:e})}),this.gotoProgress=((e,t)=>{this.setState({progress:!0,upgradeId:e,upgradeState:t})}),this.backPage=(()=>{var e=this.props.dispatch;e({type:"devstrategy/clernProgress"}),this.setState({progress:!1,showTab:"strategy",upgradeId:"",upgradeState:""})}),this.render=(()=>{var e=this.state,t=e.showTab,a=e.progress,r=e.upgradeId,i=e.upgradeState;return n.default.createElement("div",null,a?n.default.createElement(d.default,{backFunc:this.backPage,upgradeId:r,upgradeState:i}):n.default.createElement(l.default,{defaultActiveKey:t,onChange:this.onChange},n.default.createElement(c,{tab:"\u5347\u7ea7\u5305",key:"list"},n.default.createElement(o.default,null)),n.default.createElement(c,{tab:"\u7b56\u7565",key:"strategy"},n.default.createElement(s.default,{showProgress:this.gotoProgress}))))}),this.state={showTab:"list",progress:!1,upgradeId:"",upgradeState:""}}}function m(e){var t=e.upgrade;return{upgrade:t}}var g=(0,i.connect)(m)(f);t.default=g}}]);