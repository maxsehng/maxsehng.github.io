(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[31],{fo62:function(e,t,a){"use strict";var l=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("exa0");var n=l(a("KiF4")),r=l(a("xwgP")),i=a("7Qib"),s=a("pG04"),o=l(a("d78K"));class d extends r.default.Component{constructor(e){super(e),this.onMapInitEN=(e=>{var t=this.props,a=t.latlng,l=t.center;if(this.ENmap=e,e.setCenter(a&&a.lat?a:l.GPiont),a&&a.lat){var n={position:a,map:this.ENmap,icon:o.default};this.marker=new window.google.maps.Marker(n)}}),this.onMapInitCN=(e=>{var t=this.props,a=t.latlng,l=t.center;this.CNmap=e;var n=a&&a.lat?new window.BMap.Point(a.lng,a.lat):new window.BMap.Point(l.BPiont.lng,l.BPiont.lat);if(e.centerAndZoom(n,14),a&&a.lat){var r=new window.BMap.Icon(o.default,new window.BMap.Size(33,42)),i=a?new window.BMap.Marker(new window.BMap.Point(a.lng,a.lat),{icon:r}):null;e.addOverlay(i)}}),this.marker=null}render(){var e=this.props,t=e.visible,a=e.onClose;return r.default.createElement(n.default,{title:"\u5730\u56fe\u4f4d\u7f6e",visible:t,onCancel:a,footer:null,width:1e3},r.default.createElement("div",{style:{height:500}},"en"===(0,i.getLang)()?r.default.createElement(s.GMap,{onMapInit:this.onMapInitEN}):r.default.createElement(s.Map,{onMapInit:this.onMapInitCN})))}}t.default=d},wnr7:function(e,t,a){"use strict";var l=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=g(a("xwgP"));a("Mf8d");var r=l(a("4OHk"));a("26gd");var i=l(a("1GiV")),s=a("8ur3"),o=a("pG04"),d=l(a("OAgh")),u=a("t3Un"),p=l(a("fo62")),c=l(a("aESv")),h=l(a("L0Kt"));function m(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(m=function(e){return e?a:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=m(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=n?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(l,r,i):l[r]=e[r]}return l.default=e,a&&a.set(e,l),l}class f extends n.Component{constructor(e){var t;super(e),t=this,this.getFilterItems=(()=>{var e=this.props.manage.filter;return[{text:"\u540d\u79f0",name:"name",type:"input",value:e.name}]}),this.authorFields=(()=>{var e=this.state.selectRow;return[{name:"id",type:"hide",value:e.id},{text:"\u8bbe\u5907\u6570\u91cf",labelcol:6,name:"devCount",type:"number",value:e.assertLimit,style:{width:"100%"},validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8bbe\u5907\u6570\u91cf"}],trigger:["onBlur","onChange"]}]},{text:"\u6709\u6548\u65e5\u671f",labelcol:6,name:"validDate",type:"datetime",style:{width:"100%"},value:e.expire,validate:[{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6709\u6548\u671f"}]}]}]}),this.addsModal=(e=>{var t=this.props.app.language;this.setState({mapVisible:!0,latlng:"en"===t?e.latlng:e.bdlatlng})}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,n=t.props.dispatch;n({type:"manage/fetch",payload:{filter:e,pageNo:a,pageSize:l}})},this.add=((e,t)=>{var a=this.props.dispatch;a({type:"manage/add",payload:{values:e},callback:t})}),this.edit=((e,t)=>{var a=this.props.dispatch;a({type:"manage/edit",payload:{values:e},callback:t})}),this.rowClick=(e=>{d.default.push("/customer/customerdetail/?id=".concat(e.id))}),this.resetPassword=(e=>{(0,u.post)("/user/resetPassword",{loginName:e.loginName}).then(e=>{e.success?i.default.success("\u91cd\u7f6e\u5bc6\u7801\u6210\u529f\uff0c\u9ed8\u8ba4\u5bc6\u7801:123456"):i.default.error(e.message)})}),this.del=(e=>{var t=e.id,a=this.props.dispatch;a({type:"manage/del",payload:{id:t}})}),this.topInfo=(()=>{var e=this.props.manage,t=e.total,a=e.devNum;this.props.app.user;return n.default.createElement("div",{style:{position:"absolute",top:2==sessionStorage.getItem("roleId")?40:64,right:0}},n.default.createElement("span",null,"\u8bbe\u5907\u603b\u6570: ",a,"\u53f0"),n.default.createElement("span",{style:{marginLeft:30}},"\u5ba2\u6237\u603b\u6570: ",t,"\u4eba"))}),this.mapOnClose=(()=>{this.setState({mapVisible:!1})}),this.authorShow=(e=>{this.setState({author:!0,selectRow:e})}),this.commitAuthor=(e=>{var t=this.props.dispatch,a=e.validDate;(0,h.default)().isAfter(a)?i.default.warn("\u8bf7\u9009\u62e9\u5f53\u524d\u65f6\u95f4\u4e4b\u540e\u7684\u65f6\u95f4"):t({type:"manage/author",payload:{data:e},callback:{onSuccess:this.closeAuthor}})}),this.closeAuthor=(()=>{this.setState({author:!1,selectRow:{}})}),this.state={author:!1,selectRow:{},latlng:""},this.columns=[{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u7528\u6237\u540d",dataIndex:"loginName"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"phone",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";return e}},{title:"\u4e0a\u7ebf\u57df\u540d",dataIndex:"assetHost",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";return e}},{title:"\u8bbe\u5907\u4fdd\u6709\uff08\u53f0\uff09",dataIndex:"devNum",render:(e,t)=>{return"".concat(e,"/").concat(t.assertLimit?t.assertLimit:0)}},{title:"\u5728\u7ebf\u8bbe\u5907\u6570",dataIndex:"onlineDevNum"},{title:"\u5730\u5740",dataIndex:"addr",render:(e,t)=>{return n.default.createElement("div",{onClick:()=>{this.addsModal(t)},style:{cursor:"pointer"}},n.default.createElement(r.default,{type:"environment",style:{color:"#13c2c2"}}),n.default.createElement("span",null,e))}}],this.insertFields=[{text:"\u540d\u79f0",name:"name",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u540d\u79f0"}],trigger:["onBlur","onChange"]}]},{text:"\u7528\u6237\u540d",name:"loginName",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u540d"}],trigger:["onBlur","onChange"]}]},{text:"\u6635\u79f0",name:"realName",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6635\u79f0"}],trigger:["onBlur","onChange"]}]},{text:"\u7535\u8bdd",name:"phone",type:"input",labelcol:6,validate:[{rules:[{required:!1,validator:(e,t,a)=>{var l=/^1(3|4|5|6|7|8|9)\d{9}$/,n=/^(0[0-9]{2,3}-?)?([2-9][0-9]{6,7})?$/;!t||l.test(t)||n.test(t)?a():a("\u7535\u8bdd\u53f7\u7801\u9519\u8bef")}}],trigger:["onBlur"]}]},{text:"\u5730\u5740",name:"address",type:"input",labelcol:6},{text:"\u4e0a\u7ebf\u57df\u540d",name:"assetHost",type:"input",labelcol:6},{text:"\u4f4d\u7f6e",name:"latlng",type:"locselect",row:4,col:1,flex:2,labelcol:3}],this.editFields=[{text:"\u540d\u79f0",name:"name",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u540d\u79f0"}],trigger:["onBlur","onChange"]}]},{text:"\u7528\u6237\u540d",name:"loginName",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u540d"}],trigger:["onBlur","onChange"]}]},{text:"\u6635\u79f0",name:"realName",type:"input",labelcol:6,validate:[{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6635\u79f0"}],trigger:["onBlur","onChange"]}]},{text:"\u7535\u8bdd",name:"phone",type:"input",labelcol:6,validate:[{rules:[{required:!1,validator:(e,t,a)=>{var l=/^1(3|4|5|6|7|8|9)\d{9}$/,n=/^(0[0-9]{2,3}-?)?([2-9][0-9]{6,7})?$/;!t||l.test(t)||n.test(t)?a():a("\u7535\u8bdd\u53f7\u7801\u9519\u8bef")}}],trigger:["onBlur"]}]},{text:"\u5730\u5740",name:"address",type:"input",labelcol:6},{text:"\u4e0a\u7ebf\u57df\u540d",name:"assetHost",type:"input",labelcol:6,validate:[{rules:[{required:!1,validator:(e,t,a)=>{var l=new RegExp("(?=(\\b|\\D))(((\\d{1,2})|(1\\d{1,2})|(2[0-4]\\d)|(25[0-5]))\\.){3}((\\d{1,2})|(1\\d{1,2})|(2[0-4]\\d)|(25[0-5]))(?=(\\b|\\D))"),n=/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/;!t||l.test(t)||n.test(t)?a():a("\u57df\u540d\u9519\u8bef")}}],trigger:["onBlur"]}]},{text:"\u4f4d\u7f6e",name:"latlng",type:"locselect",row:4,col:1,flex:2,labelcol:3}]}render(){var e=this.props,t=e.loading,a=e.manage,l=e.app.user,r=e.addLoading,i=e.editLoading,s=this.state,d=s.author,u=s.mapVisible,h=s.latlng;return n.default.createElement("div",{style:{position:"relative"}},this.topInfo(),n.default.createElement(o.Grid,{formprop:{initNums:2},addFormProp:{columns:2},editFormProp:{columns:2},addProp:{width:900},editProp:{width:900},edit:2!=sessionStorage.getItem("roleId")&&this.edit,filterInline:!0,filterItems:this.getFilterItems(),columns:this.columns,loading:t,addLoading:r,editLoading:i,data:a,insertFields:this.insertFields,editFields:this.editFields,insert:2!=sessionStorage.getItem("roleId")&&this.add,refersh:this.refersh,del:2!=sessionStorage.getItem("roleId")&&this.del,actions:2!=sessionStorage.getItem("roleId")?[{text:"\u6388\u6743",handler:e=>{this.authorShow(e)}},{text:"\u91cd\u7f6e\u5bc6\u7801",confirm:"\u786e\u5b9a\u91cd\u7f6e\u5bc6\u7801",handler:e=>{this.resetPassword(e)}},{text:"\u8be6\u60c5",handler:e=>{this.rowClick(e)}}]:[{text:"\u8be6\u60c5",handler:e=>{this.rowClick(e)}}]}),n.default.createElement(c.default.Modal,{visible:d,fields:this.authorFields(),onSubmit:this.commitAuthor,confirmLoading:t,onCancel:this.closeAuthor,title:"\u6388\u6743"}),n.default.createElement(p.default,{center:l.location,key:h?"".concat(h.lat).concat(h.lng):null,latlng:h,visible:u,onClose:this.mapOnClose}))}}function v(e){var t=e.app,a=e.manage,l=e.loading;return{app:t,manage:a,loading:l.models.manage,addLoading:l.effects["manage/add"],editLoading:l.effects["manage/edit"]}}var w=(0,s.connect)(v)(f);t.default=w}}]);