(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[74],{"0wRI":function(e,t,r){"use strict";var a=r("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(r("xwgP"));r("yuUY");var o=a(r("2n5t")),i=r("8ur3"),s=r("pG04"),l=a(r("guZp")),p=a(r("4zaf"));function d(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(a,o,i):a[o]=e[o]}return a.default=e,r&&r.set(e,a),a}var c=o.default.Option;class f extends n.Component{constructor(e){var t;super(e),t=this,this.filterItems=(()=>{if(this.props.type){var e=this.props.logs.date;return[{text:"\u7528\u6237",name:"userId",component:n.default.createElement(l.default,{dataUrl:"/user/all",textName:"realName",valueName:"id",searchName:"realName",width:150,optionsData:{realName:"--\u7cfb\u7edf--",id:-1}})},{text:"\u7c7b\u578b",name:"type",component:n.default.createElement(o.default,{style:{width:150},allowClear:!0,placeholder:"\u8bf7\u9009\u62e9\u7c7b\u578b"},Object.keys(this.props.type).map(e=>{return n.default.createElement(c,{value:e,key:e},this.props.type[e])}))},{text:"\u8bbe\u5907\u5e8f\u5217\u53f7",name:"sn",type:"input"},{text:"\u65f6\u95f4",name:"date",value:e,type:"daterange"}]}}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=t.props.dispatch;n({type:"logs/fetch",payload:{filter:e,pageNo:r,pageSize:a}})},this.hideExportModal=(()=>{this.setState({exportVisible:!1})}),this.showExportModal=(()=>{this.setState({exportVisible:!0})}),this.logsExport=(e=>{var t=this.props.logs.filter,r=t&&t.userId?t.userId:"",a=t&&t.type?t.type:"",n=t&&t.sn?t.sn:"",o=t&&t.start?t.start:"",i=t&&t.end?t.end:"";window.open("/operationLog/export?userId=".concat(r,"&type=").concat(a,"&sn=").concat(n,"&start=").concat(o,"&end=").concat(i,"&fileType=").concat(e.fileType))}),this.state={exportVisible:!1},this.resultType={FINISH:"\u6210\u529f",FAILED:"\u5931\u8d25",CANCEL:"\u53d6\u6d88"},this.columns=[{title:"\u8bbe\u5907\u5e8f\u5217\u53f7",dataIndex:"sn"},{title:"\u7528\u6237",dataIndex:"user",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u7cfb\u7edf";return e}},{title:"\u7c7b\u578b",dataIndex:"type",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.props.type[e]}},{title:"\u5f00\u59cb\u65f6\u95f4",dataIndex:"start"},{title:"\u7ed3\u675f\u65f6\u95f4",dataIndex:"end"},{title:"\u7ed3\u679c",dataIndex:"result",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.resultType[e]}}]}render(){var e=this.props,t=e.loading,r=e.logs,a=this.state.exportVisible;return n.default.createElement("div",null,n.default.createElement(s.Grid,{formprop:{initNums:4,inline:!0},filterItems:this.filterItems(),columns:this.columns,loading:t,data:r,refersh:this.refersh,toolBtns:[{icon:"download",text:"\u65e5\u5fd7\u5bfc\u51fa",handler:this.showExportModal}]}),n.default.createElement(p.default,{visible:a,title:"\u65e5\u5fd7\u5bfc\u51fa",onCancel:this.hideExportModal,onSubmit:this.logsExport}))}}function h(e){var t=e.app,r=e.logs,a=e.loading;return{logs:r,type:t.constants.action,loading:a.models.logs}}var v=(0,i.connect)(h)(f);t.default=v}}]);