(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{QqMI:function(e,t,l){"use strict";var a=l("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=P(l("xwgP"));l("hirM");var i=a(l("/hI5"));l("exa0");var n=a(l("KiF4"));l("Gcrx");var o=a(l("Wyac"));l("6/yB");var d=a(l("SE39"));l("d+vH");var r=a(l("ijLx"));l("Mf8d");var c=a(l("4OHk"));l("0rfI");var f=a(l("vyZY"));l("iRon");var u=a(l("B0Ox"));l("SMEU");var h=a(l("xc0u")),p=a(l("mK77")),m=l("8ur3"),v=a(l("OAgh")),g=a(l("b6Or")),b=a(l("91Wn")),y=a(l("ZaKq")),E=a(l("INk7")),I=a(l("9LhY")),w=a(l("oZJ6")),S=a(l("oTW4")),C=a(l("uIy3")),k=a(l("h4nO")),_=l("t3Un"),x=a(l("yfOO"));function N(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,l=new WeakMap;return(N=function(e){return e?l:t})(e)}function P(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var l=N(t);if(l&&l.has(e))return l.get(e);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var n=s?Object.getOwnPropertyDescriptor(e,i):null;n&&(n.get||n.set)?Object.defineProperty(a,i,n):a[i]=e[i]}return a.default=e,l&&l.set(e,a),a}var M=["FINISH","FAILED","CANCEL"],V=null;class O extends s.Component{constructor(e){super(e),this.obdInfoTimer=null,this.getObdInfoData=(()=>{console.log(this.props.history.location),(0,_.post)("/obd/info",{sn:this.props.history.location.query.sn},e=>{}).then(e=>{var t,l;(console.log(e),e.success&&e.result)&&this.setState({obdInfo:(0,p.default)({},null===e||void 0===e?void 0:null===(t=e.result)||void 0===t?void 0:t.obd,{createAt:null===e||void 0===e?void 0:null===(l=e.result)||void 0===l?void 0:l.createAt})})})}),this.backBtn=(()=>{var e=this.props.dispatch;v.default.goBack(),e({type:"devdetail/clearData"}),e({type:"devstat/clearData"}),e({type:"reportform/clearData"})}),this.showProcessTip=(()=>{this.setState({tipVisible:!0})}),this.closeProcessTip=(()=>{this.setState({tipVisible:!1}),this.aftercloseStatusModal()}),this.openNetwork=(()=>{var e=this.props.dispatch,t=this.state.sn;e({type:"devhandle/openNetwork",payload:{sn:t},callback:{onSuccess:this.showProcessTip}})}),this.infoRestart=(()=>{var e=this.props.dispatch,t=this.state.sn;e({type:"devhandle/infoRestart",payload:{sn:t},callback:{onSuccess:this.showProcessTip}})}),this.smsDiagnosis=(()=>{var e=this.props.dispatch,t=this.state.sn;e({type:"devhandle/smsDiagnosis",payload:{sn:t},callback:{onSuccess:this.showProcessTip}})}),this.switchSim=(()=>{var e=this.props.dispatch,t=this.state.sn;e({type:"devhandle/switchSim",payload:{sn:t}})}),this.netRestart=(()=>{var e=this.props.dispatch,t=this.state.sn;this.setState({tipVisible:!0}),e({type:"devhandle/netRestart",payload:{sn:t},callback:{onSuccess:this.showProcessTip}})}),this.onError=(()=>{this.setState({statusVisible:!1})}),this.closeStatusModal=(()=>{this.setState({statusVisible:!1})}),this.aftercloseStatusModal=(()=>{var e=this.props,t=e.dispatch,l=e.devhandle.handelResult;M.includes(l)&&t({type:"devhandle/clearData"})}),this.openStatusModal=(()=>{this.setState({statusVisible:!0})}),this.handelCancel=(()=>{var e=this.props.dispatch;e({type:"devhandle/handelCancel"}),this.closeStatusModal()}),this.onConfigClick=(()=>{var e=this.props.dispatch,t=this.props.history.location.query.sn;e({type:"devdetail/configCtrl",payload:{sn:t,open:!0},callback:{onSuccess:this.configModalVisible}})}),this.configModalVisible=((e,t)=>{var l=this.state.configInfo.sn;if(this.setState({configVisible:e,configInfo:t}),!e&&l){var a=this.props.dispatch;a({type:"dev/configCtrl",payload:{sn:l,open:!1}})}}),this.showModal=(e=>{this.setState({showVisible:!0,title:e})}),this.closeShowModal=(()=>{this.setState({showVisible:!1,title:""})}),this.openPortModal=(()=>{var e=this.props.dispatch,t=this.props.history.location.query.sn;e({type:"devhandle/fetchOpenPort",payload:{sn:t}}),this.setState({portVisible:!0})}),this.openObdInfo=(()=>{this.props.dispatch;this.setState({obdInfoVisible:!0}),this.getObdInfoData(),V=setInterval(()=>{this.getObdInfoData()},1e3)}),this.closePortModal=(()=>{this.setState({portVisible:!1})}),this.portSubmit=(e=>{var t=e.destIp,l=e.destPort,a=this.props.dispatch,s=this.props.history.location.query.sn;a({type:"devhandle/handleOpenPort",payload:{sn:s,destIp:t,destPort:l}})}),this.closeOpenPort=(e=>{var t=e.destIp,l=e.destPort,a=e.platIp,s=e.platPort,i=e.sign,n=this.props.dispatch,o=this.props.history.location.query.sn;n({type:"devhandle/closeOpenPort",payload:{sn:o,destIp:t,destPort:l,platIp:a,platPort:s,sign:i}})}),this.issueClick=(()=>{this.setState({issueVisible:!0})}),this.closeIssue=(()=>{this.setState({issueVisible:!1})}),this.onShellClick=(()=>{var e=this.props.dispatch,t=this.props.history.location.query.sn;e({type:"devdetail/openShell",payload:{sn:t},callback:{onSuccess:this.openShellDrawer}})}),this.openShellDrawer=(e=>{this.setState({drawVisible:!0,shellInfo:e})}),this.onDrawerClose=(()=>{var e=this.props.dispatch,t=this.state,l=t.sn,a=t.shellInfo,s=void 0===a?{}:a;e({type:"devdetail/closeShell",payload:{sn:l,port:s.port}}),this.setState({drawVisible:!1,shellInfo:{}})}),this.getMoreBtns=(e=>{var t=this.props.devhandle.progressing;return s.default.createElement(u.default,null,s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{onClick:this.openNetwork,style:{height:28,lineHeight:"28px",border:"none"}},"\u77ed\u4fe1\u5f00\u7f51")),s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{onClick:this.infoRestart,style:{height:28,lineHeight:"28px",border:"none"}},"\u77ed\u4fe1\u91cd\u542f")),s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{onClick:this.smsDiagnosis,style:{height:28,lineHeight:"28px",border:"none"}},"\u77ed\u4fe1\u68c0\u6d4b")),s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{disabled:t||!e,onClick:()=>this.showModal("\u4e0b\u53d1\u914d\u7f6e"),style:{height:28,lineHeight:"28px",border:"none"}},"\u4e0b\u53d1\u914d\u7f6e")),s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{disabled:t||!e,onClick:()=>this.showModal("\u56fa\u4ef6\u5347\u7ea7"),style:{height:28,lineHeight:"28px",border:"none"}},"\u56fa\u4ef6\u5347\u7ea7")),s.default.createElement(u.default.Item,null,s.default.createElement(h.default,{onClick:this.issueClick,style:{height:28,lineHeight:"28px",border:"none"}},"\u5f02\u5e38\u65e5\u5fd7")))}),this.render=(()=>{var e=this.props.history.location.query.sn,t=this.props,l=t.app,a=t.devhandle,u=a.progressing,p=a.handleStatus,m=a.handleType,v=a.handelResult,_=a.openPort,N=t.devdetail,P=t.chartLoading,O=t.runStateLoading,L=t.portMapLoading,T=t.rctlLoading,D=t.shellLoading,H=t.menuCollapsed,R=this.state,A=R.configVisible,q=R.configInfo.url,B=R.issueVisible,j=R.showVisible,F=R.title,W=R.portVisible,U=R.obdInfoVisible,Z=R.statusVisible,K=R.tipVisible,J=R.drawVisible,Y=R.shellInfo,z=void 0===Y?{}:Y,G=R.obdInfo,Q=N.basicsInfo&&N.basicsInfo.status&&N.basicsInfo.status.online,X=window.location.hostname,$=s.default.createElement(s.default.Fragment,null,Q?s.default.createElement(f.default,{placement:"bottom",title:"\u662f\u5426\u91cd\u542f",onConfirm:this.netRestart,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},s.default.createElement(h.default,{style:{height:30,lineHeight:"30px",border:"solid 1px #e6e6e6"},disabled:u},"\u91cd\u542f")):s.default.createElement(h.default,{style:{height:30,lineHeight:"30px",border:"solid 1px #e6e6e6"},disabled:u||!Q},"\u91cd\u542f"),s.default.createElement(h.default,{onClick:this.onConfigClick,disabled:u||!Q,loading:T,style:{height:30,lineHeight:"30px",marginLeft:15,border:"solid 1px #e6e6e6"}},"\u8fdc\u7a0b\u914d\u7f6e"),s.default.createElement(h.default,{onClick:this.onShellClick,disabled:u||!Q,loading:D,style:{height:30,lineHeight:"30px",marginLeft:15,border:"solid 1px #e6e6e6"}},"SHELL"),s.default.createElement(h.default,{onClick:this.openPortModal,disabled:u||!Q,style:{height:30,lineHeight:"30px",marginLeft:15,border:"solid 1px #e6e6e6"}},"\u7aef\u53e3\u6620\u5c04"),s.default.createElement(h.default,{onClick:this.openObdInfo,style:{height:30,lineHeight:"30px",marginLeft:15,border:"solid 1px #e6e6e6"}},"OBD\u4fe1\u606f"),s.default.createElement(r.default,{overlay:this.getMoreBtns(Q),disabled:u},s.default.createElement(h.default,{style:{height:30,lineHeight:"30px",marginLeft:15,border:"solid 1px #e6e6e6"}},"\u66f4\u591a\u64cd\u4f5c ",s.default.createElement(c.default,{type:"down"})))),ee=e=>{return void 0==e?"\u6682\u65e0\u4fe1\u606f":2==e?"\u5f00\u542f":"\u5173\u95ed"},te=e=>{return(2.75*e).toFixed(1)};return s.default.createElement("div",{style:{paddingBottom:30,position:"relative"}},s.default.createElement("div",{style:{position:"fixed",top:72,height:66,left:H?72:250,width:H?"calc(100% - 72px)":"calc(100% - 250px)",backgroundColor:"#fff",zIndex:999,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0px 24px"}},s.default.createElement("div",{style:{display:"flex",alignItems:"center"}},2!=sessionStorage.getItem("roleId")&&$,u||K?s.default.createElement("div",{style:{height:41,backgroundColor:"#fdf6ec",borderRadius:4,border:"solid 1px #fbf0e4",display:"flex",alignItems:"center",paddingLeft:15,color:"#eea017",marginLeft:250}},"FINISH"===v?s.default.createElement(c.default,{type:"check-circle",theme:"twoTone",twoToneColor:"#52c41a"}):"FAILED"===v?s.default.createElement(c.default,{type:"warning",theme:"twoTone",twoToneColor:"#F5222D"}):"CANCEL"===v?s.default.createElement(c.default,{type:"close-circle",theme:"twoTone",twoToneColor:"#FAAD14"}):s.default.createElement(c.default,{type:"loading"}),s.default.createElement("span",{style:{marginLeft:10}},m||""),s.default.createElement("span",{style:{marginLeft:10}},"CANCEL"===v?"\u5df2\u53d6\u6d88":p),s.default.createElement(d.default,{title:M.includes(v)?"\u5173\u95ed":"\u8be6\u60c5"},s.default.createElement(h.default,{type:"link",style:{marginLeft:15,color:"#eea017"},onClick:()=>{M.includes(v)?this.closeProcessTip():this.openStatusModal()}},M.includes(v)?s.default.createElement(c.default,{type:"close"}):s.default.createElement(c.default,{type:"right"})))):null),s.default.createElement(h.default,{onClick:this.backBtn,type:"primary",style:{height:30}},"\u8fd4\u56de")),s.default.createElement("div",{style:{width:"calc(100% - 305px)",marginTop:82}},s.default.createElement(o.default,{spinning:P||O},s.default.createElement("div",null,s.default.createElement(b.default,null))),s.default.createElement("div",{style:{marginTop:25}},s.default.createElement(S.default,null)),s.default.createElement("div",{style:{marginTop:25}},s.default.createElement(w.default,null))),s.default.createElement("div",{style:{width:306,height:"calc(100vh - 162px)",background:"#fff",right:-10,position:"absolute",top:0}},s.default.createElement(g.default,{sn:e})),s.default.createElement(y.default,{visible:A,sn:e,url:q,onCancel:()=>this.configModalVisible(!1,{sn:"",url:""})}),s.default.createElement(E.default,{title:F,sn:e,model:N.basicsInfo?N.basicsInfo.model:"",visible:j,onCancel:this.closeShowModal,showProcessTip:this.showProcessTip,app:l}),s.default.createElement(I.default,{visible:W,sn:e,onClose:this.closePortModal,onSubmit:this.portSubmit,openPort:_,closeOpenPort:this.closeOpenPort,loading:L}),s.default.createElement(n.default,{title:"OBD\u4fe1\u606f",visible:U,onCancel:()=>{this.setState({obdInfoVisible:!1}),clearInterval(V)},onSubmit:()=>{},footer:null},G?s.default.createElement("div",{id:x.default.obdInfoModal},s.default.createElement("div",{className:x.default.content},s.default.createElement("div",{className:x.default.left},s.default.createElement("div",{className:x.default.leftItem},"\u8f66\u901f:"),s.default.createElement("div",{className:x.default.leftItem},"\u53d1\u52a8\u673a\u8f6c\u901f:"),s.default.createElement("div",{className:x.default.leftItem},"\u5269\u4f59\u71c3\u6cb9\u767e\u5206\u6bd4:"),s.default.createElement("div",{className:x.default.leftItem},"\u4fdd\u517b\u91cc\u7a0b:"),s.default.createElement("div",{className:x.default.leftItem},"\u53f3\u540e\u95e8\u72b6\u6001:"),s.default.createElement("div",{className:x.default.leftItem},"\u53f3\u524d\u95e8\u72b6\u6001:"),s.default.createElement("div",{className:x.default.leftItem},"\u5de6\u524d\u95e8\u72b6\u6001:"),s.default.createElement("div",{className:x.default.leftItem},"\u524d\u96fe\u706f\u72b6\u6001:")),s.default.createElement("div",{className:x.default.right},s.default.createElement("div",{className:x.default.rightItem},void 0==G.speed?"\u6682\u65e0\u4fe1\u606f":parseInt(.05625*G.speed)+"km/h"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.rpm?"\u6682\u65e0\u4fe1\u606f":parseInt(.5*G.rpm)+"RPM"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.left_fuel_pct?"\u6682\u65e0\u4fe1\u606f":parseInt(.5*G.left_fuel_pct)+"%"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.main_mil?"\u6682\u65e0\u4fe1\u606f":G.main_mil+"km"),s.default.createElement("div",{className:x.default.rightItem},ee(G.door_lf_status)),s.default.createElement("div",{className:x.default.rightItem},ee(G.door_lr_status)),s.default.createElement("div",{className:x.default.rightItem},ee(G.door_rr_status)),s.default.createElement("div",{className:x.default.rightItem},ee(G.light_hb)))),s.default.createElement("div",{className:x.default.content},s.default.createElement("div",{className:x.default.left},s.default.createElement("div",{className:x.default.leftItem},"\u8fdc\u5149\u706f:"),s.default.createElement("div",{className:x.default.leftItem},"\u5de6\u524d\u8f6e\u80ce\u538b\u529b\u503c:"),s.default.createElement("div",{className:x.default.leftItem},"\u53f3\u524d\u8f6e\u80ce\u538b\u529b\u503c:"),s.default.createElement("div",{className:x.default.leftItem},"\u53f3\u540e\u8f6e\u80ce\u538b\u529b\u503c:"),s.default.createElement("div",{className:x.default.leftItem},"\u5de6\u540e\u8f6e\u80ce\u538b\u529b\u503c:"),s.default.createElement("div",{className:x.default.leftItem},"\u95e8\u9501\u72b6\u6001 :"),s.default.createElement("div",{className:x.default.leftItem},"\u66f4\u65b0\u65f6\u95f4:")),s.default.createElement("div",{className:x.default.right},s.default.createElement("div",{className:x.default.rightItem},ee(G.light_f_fog)),s.default.createElement("div",{className:x.default.rightItem},void 0==G.pressure_lf?"\u6682\u65e0\u4fe1\u606f":te(G.pressure_lf)+"kPa"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.pressure_rf?"\u6682\u65e0\u4fe1\u606f":te(G.pressure_rf)+"kPa"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.pressure_rr?"\u6682\u65e0\u4fe1\u606f":te(G.pressure_rr)+"kPa"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.pressure_lr?"\u6682\u65e0\u4fe1\u606f":te(G.pressure_lr)+"kPa"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.door_rr_lock?"\u6682\u65e0\u4fe1\u606f":1==G.door_rr_lock?"\u672a\u4e0a\u9501":"\u4e0a\u9501"),s.default.createElement("div",{className:x.default.rightItem},void 0==G.createAt?"\u6682\u65e0\u4fe1\u606f":G.createAt)))):s.default.createElement("span",null,"\u6682\u65e0\u4fe1\u606f")),s.default.createElement(C.default,{visible:Z,onClose:this.closeStatusModal,handelCancel:this.handelCancel,handleStatus:p,handleType:m,handelResult:v}),s.default.createElement(k.default,{visible:B,onClose:this.closeIssue,sn:e}),s.default.createElement(i.default,{title:s.default.createElement("div",{style:{display:"flex",alignItems:"center"}},s.default.createElement("span",null,"SHELL-",z.sn),s.default.createElement(h.default,{icon:"sync",type:"link",style:{color:"#13c2c2",marginLeft:15},onClick:()=>{var t=document.getElementById("".concat(e,"-iframe"));t.src=t.src}})),width:"70%",onClose:this.onDrawerClose,visible:J,maskClosable:!1,bodyStyle:{padding:0,height:"94%"}},z.url&&s.default.createElement("iframe",{id:"".concat(z.sn,"-iframe"),src:window.location.protocol+"//"+window.location.hostname+z.url.replace(/{plateform.ip.address}/g,X),width:"100%",height:"100%",sandbox:"allow-scripts allow-forms allow-same-origin"})))}),this.state={configVisible:!1,configInfo:{sn:this.props.history.location.query,url:""},showVisible:!1,portVisible:!1,obdInfoVisible:!1,obdInfo:null,title:"",sn:this.props.history.location.query.sn,statusVisible:!1,issueVisible:!1,tipVisible:!1,drawVisible:!1,shellInfo:{}}}componentWillUnmount(){var e=this.props.dispatch;e({type:"devhandle/clearData"}),V&&clearInterval(V)}}function L(e){var t=e.app,l=e.devdetail,a=e.devhandle,s=e.loading,i=e.menu;return{app:t,devdetail:l,devhandle:a,loading:s.models.onofflog,chartLoading:s.effects["devstat/fetchOnlineRateChart"],runStateLoading:s.effects["devstat/runStatistics"],portMapLoading:s.effects["devhandle/handleOpenPort"],rctlLoading:s.effects["devdetail/configCtrl"],shellLoading:s.effects["devdetail/openShell"],menuCollapsed:i.collapsed}}var T=(0,m.connect)(L)(O);t.default=T},yfOO:function(e,t,l){e.exports={obdInfoModal:"obdInfoModal___2xf0P",content:"content___3orIp",left:"left___2hU5K",leftItem:"leftItem___wRaoX",right:"right___2Pofy",rightItem:"rightItem___1-oRe",test:"test___3eeZC"}}}]);