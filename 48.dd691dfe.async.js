(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{Mpis:function(e,t,n){"use strict";var a=n("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("exa0");var i=a(n("KiF4")),r=a(n("xwgP")),o=n("pG04"),s=a(n("w20V")),l=a(n("k4X8"));class d extends r.default.Component{constructor(e){super(e),this.afterClose=(()=>{this.setState({reset:!0})}),this.onMapInit=(e=>{var t=this.props,n=t.language,a=t.row,i=14;a.distance&&(i=a.distance<=400?17:a.distance<=900?16:a.distance<=1800?15:a.distance<=3500?14:a.distance<=7e3?13:a.distance<=14e3?12:a.distance<=28e3?11:a.distance<=56e3?10:9);var r={lat:a.oldLat,lng:a.oldLng},o={lat:a.oldBdLat,lng:a.oldBdLng},s={lat:a.newLat,lng:a.newLng},l={lat:a.newBdLat,lng:a.newBdLng};"en"===n?(this.ENmap=e,e.setOptions({center:s,zoom:i-1}),this.renderMarker(s),this.renderOldMarker(r,a.threshold)):"zh-CN"===n&&(this.CNmap=e,e.centerAndZoom(new window.BMap.Point(l.lng,l.lat),i),this.renderMarker(l),this.renderOldMarker(o,a.threshold))}),this.renderOldMarker=((e,t)=>{var n=this.props.language;if("en"===n){this.CNmap&&this.CNmap.clearOverlays();var a={position:e,map:this.ENmap,icon:l.default};this.oldENmarker=new window.google.maps.Marker(a),this.oldENmarker.addListener("click",()=>this.oldENmarkerClick());var i={strokeColor:"red",strokeOpacity:.5,strokeWeight:2,fillColor:"blue",fillOpacity:.1,map:this.ENmap,center:e,radius:t};this.ENcircle=new window.google.maps.Circle(i)}else if("zh-CN"===n){this.ENmap&&(this.oldENmarker.setMap(null),this.ENcircle.setMap(null));var r=new window.BMap.Icon(l.default,new window.BMap.Size(20,25));this.oldCNmarker=new window.BMap.Marker(new window.BMap.Point(e.lng,e.lat),{icon:r}),this.oldCNmarker.addEventListener("click",this.oldCNmarkerClick),this.CNmap.addOverlay(this.oldCNmarker),this.CNcircle=new window.BMap.Circle(new window.BMap.Point(e.lng,e.lat),t,{strokeColor:"red",strokeWeight:2,strokeOpacity:.5}),this.CNmap.addOverlay(this.CNcircle)}}),this.renderMarker=(e=>{var t=this.props.language;if("en"===t){this.CNmap&&this.CNmap.clearOverlays();var n={position:e,icon:s.default,map:this.ENmap};this.ENmarker=new window.google.maps.Marker(n),this.ENmarker.addListener("click",()=>this.ENmarkerClick())}else if("zh-CN"===t){this.ENmap&&this.ENmarker.setMap(null);var a=new window.BMap.Icon(s.default,new window.BMap.Size(33,42));this.CNmarker=new window.BMap.Marker(new window.BMap.Point(e.lng,e.lat),{icon:a}),this.CNmarker.addEventListener("click",this.newCNmarkerClick),this.CNmap.addOverlay(this.CNmarker)}}),this.oldENmarkerClick=(()=>{this.infoWindow&&this.infoWindow.close();var e=new window.google.maps.InfoWindow({content:"\u56f4\u680f\u4e2d\u5fc3\u4f4d\u7f6e"});this.infoWindow=e,e.open(this.ENmap,this.oldENmarker)}),this.ENmarkerClick=(()=>{this.infoWindow&&this.infoWindow.close();var e=new window.google.maps.InfoWindow({content:"\u8bbe\u5907\u5f53\u524d\u4f4d\u7f6e"});this.infoWindow=e,e.open(this.ENmap,this.ENmarker)}),this.oldCNmarkerClick=(e=>{var t=e.target,n=new window.BMap.InfoWindow("\u56f4\u680f\u4e2d\u5fc3\u4f4d\u7f6e");t.openInfoWindow(n)}),this.newCNmarkerClick=(e=>{var t=e.target,n=new window.BMap.InfoWindow("\u8bbe\u5907\u5f53\u524d\u4f4d\u7f6e");t.openInfoWindow(n)}),this.state={reset:!1}}render(){var e=this.state.reset;if(e)return this.state.reset=!1,null;var t=this.props,n=t.visible,a=t.onCancel,s=t.language;return r.default.createElement(i.default,{title:"\u8bbe\u5907\u4f4d\u7f6e",visible:n,onCancel:a,afterClose:this.afterClose,footer:null,width:800},r.default.createElement("div",{style:{height:600,width:"100%"}},"en"===s?r.default.createElement(o.GMap,{onMapInit:this.onMapInit}):r.default.createElement(o.Map,{onMapInit:this.onMapInit})))}}t.default=d},y4FW:function(e,t,n){"use strict";var a=n("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("6/yB");var i=a(n("SE39")),r=n("8ur3"),o=c(n("xwgP")),s=n("pG04"),l=a(n("Mpis")),d=a(n("4zaf"));function p(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(a,r,o):a[r]=e[r]}return a.default=e,n&&n.set(e,a),a}class h extends o.Component{constructor(e){var t;super(e),t=this,this.filterItems=(()=>{var e=this.props.gpsFenceLog.date;return[{text:"\u8bbe\u5907\u5e8f\u5217\u53f7",name:"sn",type:"input"},{text:"\u65f6\u95f4",name:"date",value:e,type:"daterange"}]}),this.refersh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=t.props.dispatch;i({type:"gpsFenceLog/fetch",payload:{filter:e,pageNo:n,pageSize:a}})},this.logsExport=(e=>{var t=this.props.gpsFenceLog.filter,n=t&&t.sn?t.sn:"",a=t&&t.start?t.start:"",i=t&&t.end?t.end:"";this.setState({confirmLoading:!0}),window.open("/gpsFenceLog/export?sn=".concat(n,"&start=").concat(a,"&end=").concat(i,"&fileType=").concat(e.fileType))}),this.onClose=(()=>{this.setState({modalVisiable:!1,row:{}})}),this.onOpen=(e=>{this.setState({modalVisiable:!0,row:e})}),this.hideExportModal=(()=>{this.setState({exportVisible:!1})}),this.showExportModal=(()=>{this.setState({exportVisible:!0})}),this.state={modalVisiable:!1,row:{},exportVisible:!1},this.columns=[{title:"\u8bbe\u5907\u5e8f\u5217\u53f7",dataIndex:"sn"},{title:"\u540d\u79f0",dataIndex:"devName",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";return e}},{title:"\u5730\u5740",dataIndex:"address",render:(e,t)=>{return e?o.default.createElement(i.default,{placement:"top",title:e,arrowPointAtCenter:!0},o.default.createElement("a",{onClick:()=>this.onOpen(t)},e.length>20?"".concat(e.substring(0,20),"..."):e)):"-"}},{title:"\u9501\u5b9a\u5750\u6807",dataIndex:"oldLng",render:(e,t)=>{return t.oldLng+","+t.oldLat}},{title:"\u544a\u8b66\u5750\u6807",dataIndex:"newLng",render:(e,t)=>{return t.newLng+","+t.newLat}},{title:"\u9608\u503c",dataIndex:"threshold",render:e=>{return e+"m"}},{title:"\u4f4d\u79fb",dataIndex:"distance",render:e=>{return e+"m"}},{title:"\u544a\u8b66\u65f6\u95f4",dataIndex:"time"}]}render(){var e=this.props,t=e.app.language,n=e.loading,a=e.gpsFenceLog,i=this.state,r=i.modalVisiable,p=i.row,c=i.exportVisible;return o.default.createElement("div",null,o.default.createElement(s.Grid,{formprop:{initNums:2},filterItems:this.filterItems(),columns:this.columns,loading:n,data:a,refersh:this.refersh,toolBtns:[{icon:"download",text:"\u65e5\u5fd7\u5bfc\u51fa",handler:this.showExportModal}]}),o.default.createElement(d.default,{visible:c,title:"\u65e5\u5fd7\u5bfc\u51fa",onCancel:this.hideExportModal,onSubmit:this.logsExport}),o.default.createElement(l.default,{onCancel:this.onClose,visible:r,language:t,row:p}))}}function w(e){var t=e.app,n=e.gpsFenceLog,a=e.loading;return{app:t,gpsFenceLog:n,loading:a.models.gpsFenceLog}}var u=(0,r.connect)(w)(h);t.default=u}}]);